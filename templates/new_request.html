{% extends "./base.html"%}
{% block title %}New requests{% endblock %}
{% block content %}
<div class="md:bg-gray-200 sm:bg-gray-400 py-4 h-full sm:px-2 md:px-24 mheight">
    {% for new_request in new_requests %}
        <div class="py-2 rounded-lg bg-white my-4 p-4">
            <p class="text-2xl">{{ new_request.user.username }}</p>
            <p class="text-xl py-2 text-gray-600">{{new_request.request}}</p>
            <p class="text-xl text-gray-600">{{ new_request.datetime|humanize() }}</p>
            <!-- {{ new_request.not_seen }} -->
        </div>      
    {% endfor %}
    <button class="bg-gray-500 text-xl text-white py-2 px-4 rounded-lg mt-2" id="more_request">More</button>

</div>

<script>
    let more_request = document.getElementById("more_request")
    let max_paginate = Number("{{ max_pagination_no }}")
    
    var page_no = 1
    more_request.addEventListener("click", async () =>{
        page_no++
        let res = await fetch(`/new-requests?page=${page_no}`)
        let data = await res.json()
        
        if(page_no >= max_paginate){
            more_request.style.display = "none"
            console.log(max_paginate)
        }
    })    
    
    let mark_seen = async () =>{
        let res = await fetch(`/seen-requests`)
        if(res.ok) console.log("Gone")
    }
    mark_seen()
</script>
{% endblock %}